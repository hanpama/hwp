# hwp

A Go library for reading and rendering HWP and HWPX documents to plain text.

## Installation

```bash
go get github.com/hanpama/hwp
```

## Usage

### As a Library

```go
package main

import (
	"os"
	"github.com/hanpama/hwp"
)

func main() {
	file, err := os.Open("document.hwp")
	if err != nil {
		panic(err)
	}
	defer file.Close()

	// Auto-detect format and render to stdout
	if err := hwp.Read(file, os.Stdout); err != nil {
		panic(err)
	}
}
```

### Specific Format Readers

```go
// Read HWP v5 binary format
file, _ := os.Open("document.hwp")
hwp.ReadHWP(file, os.Stdout)

// Read HWPX (XML) format
file, _ := os.Open("document.hwpx")
info, _ := file.Stat()
hwp.ReadHWPX(file, info.Size(), os.Stdout)
```

### Command Line Tool

```bash
# Install the CLI tool
go install github.com/hanpama/hwp/hwpcat@latest

# Convert HWP to text
hwpcat document.hwp > output.txt

# Works with HWPX too
hwpcat document.hwpx > output.txt
```

## Output Example

```
바이너리 데이터
Tag ID : HWPTAG_BIN_DATA

표  바이너리 데이터
+---------------------+----------------+----------------------------------------+------------------------------+
| 자료형              | 길이(바이트)   | 설명                                                                  |
+---------------------+----------------+-----------------------------------------------------------------------+
| 그림, OLE 등의 바이너리 데이터 아이템에 대한 정보                                                            |
+---------------------+----------------+-----------------------------------------------------------------------+
| UINT16              | 2              | 속성(표 18 참조)                                                      |
+---------------------+----------------+-----------------------------------------------------------------------+
| WORD                | 2              | Type이 "LINK"일 때, 연결 파일의 절대 경로 길이 (len1)                 |
+---------------------+----------------+-----------------------------------------------------------------------+
| WCHAR array[len1]   | 2×len1         | Type이 "LINK"일 때, 연결 파일의 절대 경로                             |
+---------------------+----------------+-----------------------------------------------------------------------+
| WORD                | 2              | Type이 "LINK"일 때, 연결 파일의 상대 경로 길이 (len2)                 |
+---------------------+----------------+-----------------------------------------------------------------------+
| WCHAR array[len2]   | 2×len2         | Type이 "LINK"일 때, 연결 파일의 상대 경로                             |
+---------------------+----------------+-----------------------------------------------------------------------+
| UINT16              | 2              | Type이 "EMBEDDING"이거나 "STORAGE"일 때,                              |
|                     |                | BINDATASTORAGE에 저장된 바이너리 데이터의 아이디                      |
+---------------------+----------------+-----------------------------------------------------------------------+
| WORD                | 2              | Type이 "EMBEDDING"일 때, 바이너리 데이터의 형식 이름의 길이 (len3)    |
+---------------------+----------------+-----------------------------------------------------------------------+
| WCHAR array[len3]   | 2×len3         | Type이 "EMBEDDING"일 때 extension("." 제외)                           |
+                     +                +----------------------------------------+------------------------------+
|                     |                | 그림의 경우                            | jpg                          |
+                     +                +                                        +------------------------------+
|                     |                |                                        | bmp                          |
+                     +                +                                        +------------------------------+
|                     |                |                                        | gif                          |
+                     +                +----------------------------------------+------------------------------+
|                     |                | OLE의 경우                             | ole                          |
+---------------------+----------------+----------------------------------------+------------------------------+
| 전체 길이           | 가변           | 10 + (2×len1) + (2×len2) + (2×len3) 바이트                            |
+---------------------+----------------+----------------------------------------+------------------------------+


표  바이너리 데이터 속성
...
```
